<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DLP Risk Analyzer - Proje DokÃ¼mantasyonu</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
            background: #f5f7fa;
        }

        h1 {
            color: #1a1f2e;
            font-size: 32px;
            margin-bottom: 10px;
            border-bottom: 3px solid #00a8e8;
            padding-bottom: 10px;
        }

        h2 {
            color: #2c3e50;
            font-size: 24px;
            margin: 30px 0 15px;
            padding: 10px 15px;
            background: linear-gradient(135deg, #00a8e8, #0066cc);
            color: white;
            border-radius: 5px;
        }

        h3 {
            color: #00a8e8;
            font-size: 18px;
            margin: 20px 0 10px;
        }

        h4 {
            color: #2c3e50;
            font-size: 16px;
            margin: 15px 0 8px;
        }

        p {
            margin-bottom: 12px;
            text-align: justify;
        }

        .card {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #00a8e8;
        }

        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .tech-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border-top: 4px solid #00a8e8;
        }

        .tech-card h4 {
            color: #00a8e8;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tech-card .icon {
            font-size: 24px;
        }

        code {
            background: #e8f4f8;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            color: #0066cc;
        }

        pre {
            background: #1a1f2e;
            color: #e8eaed;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 13px;
            margin: 15px 0;
        }

        pre code {
            background: transparent;
            color: #e8eaed;
            padding: 0;
        }

        .endpoint {
            background: #f0f7ff;
            border: 1px solid #b8d4f0;
            border-radius: 6px;
            padding: 12px 15px;
            margin: 10px 0;
        }

        .endpoint .method {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 12px;
            margin-right: 10px;
        }

        .endpoint .post {
            background: #49cc90;
            color: white;
        }

        .endpoint .get {
            background: #61affe;
            color: white;
        }

        .endpoint .url {
            font-family: 'Consolas', monospace;
            color: #333;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        th {
            background: #2c3e50;
            color: white;
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .flow-diagram {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .flow-box {
            display: inline-block;
            background: white;
            border: 2px solid #00a8e8;
            border-radius: 8px;
            padding: 15px 20px;
            margin: 5px;
            min-width: 150px;
        }

        .flow-arrow {
            display: inline-block;
            color: #00a8e8;
            font-size: 24px;
            margin: 0 10px;
        }

        .step-number {
            display: inline-flex;
            width: 30px;
            height: 30px;
            background: #00a8e8;
            color: white;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
        }

        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .info {
            background: #e7f3ff;
            border-left: 4px solid #0066cc;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        /* ========================================
           A4 PDF / PRINT STYLES
           ======================================== */
        @media print {
            @page {
                size: A4;
                margin: 15mm 15mm 20mm 15mm;
            }

            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            body {
                background: white !important;
                padding: 0 !important;
                margin: 0 !important;
                max-width: 100% !important;
                font-size: 11pt;
                line-height: 1.4;
            }

            h1 {
                font-size: 22pt;
                page-break-after: avoid;
            }

            h2 {
                font-size: 16pt;
                page-break-after: avoid;
                margin-top: 20px;
            }

            h3 {
                font-size: 13pt;
                page-break-after: avoid;
            }

            h4 {
                font-size: 11pt;
                page-break-after: avoid;
            }

            /* Prevent content from splitting across pages */
            .card,
            .tech-card,
            .toc,
            .flow-diagram,
            .warning,
            .info,
            .success {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
                box-shadow: none !important;
                border: 1px solid #ddd !important;
            }

            table {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
                box-shadow: none !important;
                border: 1px solid #ddd !important;
                font-size: 10pt;
            }

            tr {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            pre {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
                white-space: pre-wrap !important;
                word-wrap: break-word !important;
                font-size: 9pt;
                max-height: none !important;
                overflow: visible !important;
            }

            .endpoint {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            /* Tech grid - force 2 columns for print */
            .tech-grid {
                display: grid !important;
                grid-template-columns: 1fr 1fr !important;
                gap: 10px !important;
            }

            .tech-card {
                padding: 12px !important;
                font-size: 10pt;
            }

            /* Force page breaks before major sections */
            h2 {
                page-break-before: auto;
            }

            /* Don't break inside these elements */
            img,
            svg,
            figure {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            /* Hide elements not needed in print */
            .no-print {
                display: none !important;
            }

            /* Ensure links are visible */
            a {
                color: #0066cc !important;
                text-decoration: none !important;
            }

            /* Table of contents styling for print */
            .toc {
                border: 1px solid #ddd;
                padding: 15px;
            }

            .toc ul ul {
                margin-left: 20px;
            }

            /* Compact code for print */
            code {
                font-size: 9pt;
                background: #f0f0f0 !important;
            }

            /* Reduce margins for print */
            .card {
                margin: 10px 0 !important;
                padding: 15px !important;
            }

            p {
                orphans: 3;
                widows: 3;
            }
        }

        .toc {
            background: white;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .toc ul {
            list-style: none;
        }

        .toc li {
            padding: 5px 0;
        }

        .toc a {
            color: #00a8e8;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        .header-info {
            color: #666;
            font-size: 14px;
            margin-bottom: 30px;
        }
    </style>
</head>

<body>

    <h1>ğŸ›¡ï¸ DLP Risk Analyzer - Proje DokÃ¼mantasyonu</h1>
    <p class="header-info">Forcepoint DLP Adaptive Risk Protection Sistemi | Versiyon 1.0 | OluÅŸturulma: 11 AralÄ±k 2025
    </p>

    <div class="toc">
        <h3>ğŸ“‹ Ä°Ã§indekiler</h3>
        <ul>
            <li><a href="#teknolojiler">1. KullanÄ±lan Teknolojiler</a></li>
            <li><a href="#mimari">2. Sistem Mimarisi</a></li>
            <li><a href="#veri-toplama">3. DLP API'den Veri Toplama</a></li>
            <li><a href="#redis-islemleri">4. Redis Stream Ä°ÅŸlemleri</a></li>
            <li><a href="#veritabani">5. PostgreSQL VeritabanÄ± Ä°ÅŸlemleri</a></li>
            <li><a href="#risk-analizi">6. Risk Skoru Hesaplama</a>
                <ul>
                    <li><a href="#risk-analizi">6.1 Hesaplama FormÃ¼lÃ¼</a></li>
                    <li><a href="#risk-analizi">6.2 Skor Hesaplama DetaylarÄ± (Severity, RepeatCount,
                            DataSensitivity)</a></li>
                    <li><a href="#risk-analizi">6.3 Politika AksiyonlarÄ± Matrisi</a></li>
                    <li><a href="#risk-analizi">6.4 IOB Tespiti</a></li>
                    <li><a href="#risk-analizi">6.5 Sabit DeÄŸerler (Constants)</a></li>
                </ul>
            </li>
            <li><a href="#ai-analiz">7. AI DavranÄ±ÅŸ Analizi</a></li>
            <li><a href="#remediation">8. Olay DÃ¼zeltme (Remediation)</a></li>
            <li><a href="#frontend">9. Dashboard (Frontend)</a></li>
            <li><a href="#api-endpoints">10. API Endpoint'leri</a></li>
            <li><a href="#action-summary-modal">11. Action Summary Incident Details (YENÄ°)</a></li>
        </ul>
    </div>

    <h2 id="teknolojiler">1. KullanÄ±lan Teknolojiler</h2>

    <div class="tech-grid">
        <div class="tech-card">
            <h4><span class="icon">ğŸ˜</span> PostgreSQL</h4>
            <p><strong>AmaÃ§:</strong> Ana veritabanÄ± sistemi</p>
            <p>Incident'lar, kullanÄ±cÄ±lar, AI analizleri ve sistem ayarlarÄ± burada saklanÄ±r. Entity Framework Core ile
                ORM desteÄŸi saÄŸlanÄ±r.</p>
            <p><strong>Tablolar:</strong> Incidents, Users, AIBehavioralAnalyses, SystemSettings, AuditLogs</p>
        </div>

        <div class="tech-card">
            <h4><span class="icon">ğŸ”´</span> Redis</h4>
            <p><strong>AmaÃ§:</strong> Mesaj kuyruÄŸu (Stream)</p>
            <p>DLP API'den Ã§ekilen incident'lar Ã¶nce Redis Stream'e yazÄ±lÄ±r. Bu sayede veri kaybÄ± Ã¶nlenir ve asenkron
                iÅŸleme saÄŸlanÄ±r.</p>
            <p><strong>Stream:</strong> <code>dlp:incidents</code></p>
        </div>

        <div class="tech-card">
            <h4><span class="icon">ğŸ”·</span> .NET 8 / C#</h4>
            <p><strong>AmaÃ§:</strong> Backend API</p>
            <p>ASP.NET Core Web API ile RESTful servisler sunulur. Dependency Injection, Entity Framework Core,
                Background Services kullanÄ±lÄ±r.</p>
        </div>

        <div class="tech-card">
            <h4><span class="icon">âš›ï¸</span> Next.js / React</h4>
            <p><strong>AmaÃ§:</strong> Frontend Dashboard</p>
            <p>TypeScript ile yazÄ±lmÄ±ÅŸ modern dashboard. Plotly.js ile grafikler, Tailwind CSS ile stil, Axios ile API
                iletiÅŸimi.</p>
        </div>

        <div class="tech-card">
            <h4><span class="icon">ğŸ”’</span> Forcepoint DLP API</h4>
            <p><strong>AmaÃ§:</strong> Veri kaynaÄŸÄ±</p>
            <p>Forcepoint DLP Manager REST API v1 Ã¼zerinden incident verileri Ã§ekilir. JWT token tabanlÄ± kimlik
                doÄŸrulama kullanÄ±lÄ±r.</p>
        </div>

        <div class="tech-card">
            <h4><span class="icon">ğŸ¤–</span> OpenAI / Azure OpenAI</h4>
            <p><strong>AmaÃ§:</strong> AI Analiz</p>
            <p>DavranÄ±ÅŸ anomalilerinin aÃ§Ä±klamasÄ± ve Ã¶nerileri iÃ§in GPT modelleri kullanÄ±lÄ±r. Opsiyonel entegrasyon.</p>
        </div>
    </div>

    <h2 id="mimari">2. Sistem Mimarisi</h2>

    <div class="card">
        <h3>Veri AkÄ±ÅŸ DiyagramÄ±</h3>
        <div class="flow-diagram">
            <div class="flow-box"><strong>Forcepoint DLP</strong><br>Manager API</div>
            <span class="flow-arrow">â†’</span>
            <div class="flow-box"><strong>Collector</strong><br>Service</div>
            <span class="flow-arrow">â†’</span>
            <div class="flow-box"><strong>Redis</strong><br>Stream</div>
            <span class="flow-arrow">â†’</span>
            <div class="flow-box"><strong>Analyzer</strong><br>Service</div>
            <span class="flow-arrow">â†’</span>
            <div class="flow-box"><strong>PostgreSQL</strong><br>Database</div>
            <span class="flow-arrow">â†’</span>
            <div class="flow-box"><strong>Dashboard</strong><br>Next.js</div>
        </div>
    </div>

    <div class="card">
        <h3>Proje YapÄ±sÄ±</h3>
        <table>
            <tr>
                <th>Proje</th>
                <th>AÃ§Ä±klama</th>
                <th>Port</th>
            </tr>
            <tr>
                <td><code>DLP.RiskAnalyzer.Collector</code></td>
                <td>DLP API'den veri toplama servisi</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>DLP.RiskAnalyzer.Analyzer</code></td>
                <td>Ana API servisi (Backend)</td>
                <td>5062</td>
            </tr>
            <tr>
                <td><code>DLP.RiskAnalyzer.Shared</code></td>
                <td>Ortak modeller ve sabitler</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>DLP.RiskAnalyzer.Dashboard</code></td>
                <td>WPF Desktop UygulamasÄ±</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>dashboard</code></td>
                <td>Next.js Web Dashboard</td>
                <td>3002</td>
            </tr>
        </table>
    </div>

    <h2 id="veri-toplama">3. DLP API'den Veri Toplama</h2>

    <div class="card">
        <p><strong>Dosya:</strong> <code>DLP.RiskAnalyzer.Collector/Services/DLPCollectorService.cs</code></p>

        <h3><span class="step-number">1</span> Kimlik DoÄŸrulama (Authentication)</h3>
        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="url">/dlp/rest/v1/auth/access-token</span>
        </div>
        <pre><code>// Ä°stek Headers
Headers:
  username: &lt;DLP kullanÄ±cÄ± adÄ±&gt;
  password: &lt;DLP ÅŸifresi&gt;

// YanÄ±t
{
  "access_token": "eyJhbGciOiJSUzI1NiIsInR5c...",
  "access_token_expires_in": 3600
}</code></pre>

        <h3><span class="step-number">2</span> Incident'larÄ± Ã‡ekme</h3>
        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="url">/dlp/rest/v1/incidents/</span>
        </div>
        <pre><code>// Ä°stek Headers
Authorization: Bearer &lt;access_token&gt;
Content-Type: application/json

// Ä°stek Body
{
  "type": "INCIDENTS",
  "from_date": "01/12/2024 00:00:00",
  "to_date": "10/12/2024 23:59:59",
  "start": 0,
  "limit": 100
}

// YanÄ±t
{
  "incidents": [
    {
      "id": 12345,
      "severity": "HIGH",
      "source": {
        "login_name": "john.doe@company.com",
        "department": "Finance"
      },
      "incident_time": "05/12/2024 14:30:00",
      "channel": "Email",
      "policies": "Data Loss Prevention"
    }
  ],
  "total": 150
}</code></pre>
    </div>

    <h2 id="redis-islemleri">4. Redis Stream Ä°ÅŸlemleri</h2>

    <div class="card">
        <p><strong>Dosya:</strong> <code>DLPCollectorService.cs</code> (SatÄ±r 233-260)</p>

        <h3><span class="step-number">1</span> Stream'e Yazma</h3>
        <pre><code>// Redis Stream'e incident yazma
var streamName = "dlp:incidents";
var fields = new NameValueEntry[]
{
    new("user", incident.UserEmail),
    new("department", incident.Department ?? ""),
    new("severity", incident.Severity.ToString()),
    new("data_type", incident.DataType ?? ""),
    new("timestamp", incident.Timestamp.ToString("O")),
    new("policy", incident.Policy ?? ""),
    new("channel", incident.Channel ?? "")
};

await db.StreamAddAsync(streamName, fields);</code></pre>

        <h3><span class="step-number">2</span> Stream'den Okuma</h3>
        <p><strong>Dosya:</strong> <code>DatabaseService.cs</code> (SatÄ±r 71-185)</p>
        <pre><code>// Consumer Group ile okuma
var consumerGroup = "analyzer";
var messages = await db.StreamReadGroupAsync(
    streamName, 
    consumerGroup, 
    consumerName, 
    ">",        // Yeni mesajlarÄ± oku
    count: 100  // Max 100 mesaj
);

// Ä°ÅŸleme sonrasÄ± acknowledge
await db.StreamAcknowledgeAsync(streamName, consumerGroup, message.Id);</code></pre>
    </div>

    <h2 id="veritabani">5. PostgreSQL VeritabanÄ± Ä°ÅŸlemleri</h2>

    <div class="card">
        <h3>Incident Tablosu</h3>
        <table>
            <tr>
                <th>Alan</th>
                <th>Tip</th>
                <th>AÃ§Ä±klama</th>
            </tr>
            <tr>
                <td>Id</td>
                <td>int</td>
                <td>Primary Key</td>
            </tr>
            <tr>
                <td>UserEmail</td>
                <td>string</td>
                <td>KullanÄ±cÄ± e-postasÄ±</td>
            </tr>
            <tr>
                <td>Department</td>
                <td>string?</td>
                <td>Departman</td>
            </tr>
            <tr>
                <td>Severity</td>
                <td>int</td>
                <td>Ciddiyet (1-5)</td>
            </tr>
            <tr>
                <td>DataType</td>
                <td>string?</td>
                <td>Veri tipi (PII, PCI...)</td>
            </tr>
            <tr>
                <td>Timestamp</td>
                <td>DateTime</td>
                <td>Olay zamanÄ±</td>
            </tr>
            <tr>
                <td>Policy</td>
                <td>string?</td>
                <td>Tetiklenen politika</td>
            </tr>
            <tr>
                <td>Channel</td>
                <td>string?</td>
                <td>Kanal (Email, USB...)</td>
            </tr>
            <tr>
                <td>RiskScore</td>
                <td>int?</td>
                <td>Risk skoru (0-100)</td>
            </tr>
            <tr>
                <td>RepeatCount</td>
                <td>int</td>
                <td>Tekrar sayÄ±sÄ±</td>
            </tr>
            <tr>
                <td>DataSensitivity</td>
                <td>int</td>
                <td>Veri hassasiyeti</td>
            </tr>
        </table>
    </div>

    <h2 id="risk-analizi">6. Risk Skoru Hesaplama</h2>

    <div class="card">
        <p><strong>Dosya:</strong> <code>DLP.RiskAnalyzer.Shared/Services/RiskAnalyzer.cs</code></p>

        <h3>Hesaplama FormÃ¼lÃ¼</h3>
        <pre><code>RiskScore = (Severity Ã— 3) + (RepeatCount Ã— 2) + (DataSensitivity Ã— 5)

// Maksimum 100 ile sÄ±nÄ±rlandÄ±rÄ±lÄ±r
return Math.Min(100, baseScore);</code></pre>

        <h3>Risk Seviyeleri</h3>
        <table>
            <tr>
                <th>Skor AralÄ±ÄŸÄ±</th>
                <th>Seviye</th>
                <th>Aksiyon</th>
            </tr>
            <tr>
                <td>91-100</td>
                <td style="color: #dc2626; font-weight: bold;">Critical</td>
                <td>Block (Engelle)</td>
            </tr>
            <tr>
                <td>61-90</td>
                <td style="color: #f59e0b; font-weight: bold;">High</td>
                <td>Encrypt (Åifrele)</td>
            </tr>
            <tr>
                <td>41-60</td>
                <td style="color: #eab308; font-weight: bold;">Medium</td>
                <td>Confirm Prompt (Onay Ä°ste)</td>
            </tr>
            <tr>
                <td>0-40</td>
                <td style="color: #10b981; font-weight: bold;">Low</td>
                <td>Audit (Kaydet)</td>
            </tr>
        </table>

        <h3>Veri Hassasiyeti EÅŸikleri</h3>
        <pre><code>PII (KiÅŸisel Bilgi)   â†’ Threshold: 8
PCI (Ã–deme KartÄ±)     â†’ Threshold: 9
Confidential (Gizli)  â†’ Threshold: 7</code></pre>
    </div>

    <div class="card">
        <h3>ğŸ“Š Skor Hesaplama DetaylarÄ±</h3>
        <p><strong>Dosya:</strong> <code>DLP.RiskAnalyzer.Shared/Constants/RiskConstants.cs</code> ve
            <code>RiskAnalyzer.cs</code>
        </p>

        <div class="warning">
            <strong>âš ï¸ Ã–nemli:</strong> Sistem tÃ¼m DLP politikalarÄ±ndan baÄŸÄ±msÄ±z olarak Ã§alÄ±ÅŸÄ±r. Politikalar Forcepoint
            DLP'den alÄ±nÄ±r, ancak risk skoru aÅŸaÄŸÄ±daki 3 faktÃ¶re gÃ¶re hesaplanÄ±r.
        </div>

        <h4>1ï¸âƒ£ Severity (Ciddiyet) - AÄŸÄ±rlÄ±k: Ã—3</h4>
        <p>Forcepoint DLP API'den gelen <code>severity</code> deÄŸeri string olarak alÄ±nÄ±r ve sayÄ±ya dÃ¶nÃ¼ÅŸtÃ¼rÃ¼lÃ¼r:</p>
        <table>
            <tr>
                <th>API DeÄŸeri</th>
                <th>SayÄ±sal DeÄŸer</th>
                <th>Skor KatkÄ±sÄ±</th>
            </tr>
            <tr>
                <td>LOW</td>
                <td>1</td>
                <td>1 Ã— 3 = 3</td>
            </tr>
            <tr>
                <td>MEDIUM</td>
                <td>2</td>
                <td>2 Ã— 3 = 6</td>
            </tr>
            <tr>
                <td>HIGH</td>
                <td>3</td>
                <td>3 Ã— 3 = 9</td>
            </tr>
            <tr>
                <td>CRITICAL</td>
                <td>4</td>
                <td>4 Ã— 3 = 12</td>
            </tr>
        </table>

        <h4>2ï¸âƒ£ RepeatCount (Tekrar SayÄ±sÄ±) - AÄŸÄ±rlÄ±k: Ã—2</h4>
        <p>AynÄ± kullanÄ±cÄ±nÄ±n benzer olaylarÄ± tekrarlama sayÄ±sÄ±. Bu deÄŸer veritabanÄ±nda takip edilir.</p>
        <table>
            <tr>
                <th>Tekrar SayÄ±sÄ±</th>
                <th>Skor KatkÄ±sÄ±</th>
                <th>AÃ§Ä±klama</th>
            </tr>
            <tr>
                <td>0-2</td>
                <td>0-4</td>
                <td>Normal davranÄ±ÅŸ</td>
            </tr>
            <tr>
                <td>3-5</td>
                <td>6-10</td>
                <td>Dikkat edilmeli</td>
            </tr>
            <tr>
                <td>6-10</td>
                <td>12-20</td>
                <td>ÅÃ¼pheli aktivite</td>
            </tr>
            <tr>
                <td>10+</td>
                <td>20+</td>
                <td>IOB-311 (Stockpiling) tetiklenir</td>
            </tr>
        </table>

        <h4>3ï¸âƒ£ DataSensitivity (Veri Hassasiyeti) - AÄŸÄ±rlÄ±k: Ã—5</h4>
        <p>Veri tipi (DataType) alanÄ±na gÃ¶re hassasiyet seviyesi belirlenir:</p>
        <table>
            <tr>
                <th>Veri Tipi</th>
                <th>EÅŸik DeÄŸeri</th>
                <th>Skor KatkÄ±sÄ± (Ã—5)</th>
            </tr>
            <tr>
                <td>PCI (Ã–deme KartÄ±)</td>
                <td>9</td>
                <td>9 Ã— 5 = 45</td>
            </tr>
            <tr>
                <td>PII (KiÅŸisel Bilgi)</td>
                <td>8</td>
                <td>8 Ã— 5 = 40</td>
            </tr>
            <tr>
                <td>Confidential (Gizli)</td>
                <td>7</td>
                <td>7 Ã— 5 = 35</td>
            </tr>
            <tr>
                <td>Financial (Finansal)</td>
                <td>6</td>
                <td>6 Ã— 5 = 30</td>
            </tr>
            <tr>
                <td>Health (SaÄŸlÄ±k)</td>
                <td>6</td>
                <td>6 Ã— 5 = 30</td>
            </tr>
            <tr>
                <td>Internal (Åirket Ä°Ã§i)</td>
                <td>4</td>
                <td>4 Ã— 5 = 20</td>
            </tr>
            <tr>
                <td>Public (Genel)</td>
                <td>1</td>
                <td>1 Ã— 5 = 5</td>
            </tr>
        </table>

        <h4>ğŸ“ Ã–rnek Hesaplama</h4>
        <pre><code>// Senaryo: YÃ¼ksek ciddiyetli, 3 kez tekrarlanan PII verisi sÄ±zÄ±ntÄ±sÄ±
Severity = HIGH (3)       â†’ 3 Ã— 3 = 9
RepeatCount = 3           â†’ 3 Ã— 2 = 6  
DataSensitivity = PII (8) â†’ 8 Ã— 5 = 40
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Toplam Risk Skoru         = 9 + 6 + 40 = 55 (Medium Risk)</code></pre>
    </div>

    <div class="card">
        <h3>ğŸ¯ Politika AksiyonlarÄ± Matrisi</h3>
        <p><strong>Dosya:</strong> <code>RiskAnalyzer.cs</code> - <code>GetPolicyAction()</code> metodu</p>
        <p>Risk seviyesi ve kanal kombinasyonuna gÃ¶re otomatik aksiyon Ã¶nerilir:</p>

        <table>
            <tr>
                <th>Risk Seviyesi</th>
                <th>Email</th>
                <th>USB</th>
                <th>Cloud</th>
                <th>Web</th>
                <th>Print</th>
            </tr>
            <tr>
                <td style="color: #dc2626; font-weight: bold;">Critical (91-100)</td>
                <td>Block</td>
                <td>Block</td>
                <td>Block</td>
                <td>Block</td>
                <td>Block</td>
            </tr>
            <tr>
                <td style="color: #f59e0b; font-weight: bold;">High (61-90)</td>
                <td>Encrypt</td>
                <td>Encrypt</td>
                <td>Encrypt</td>
                <td>Encrypt</td>
                <td>Notify</td>
            </tr>
            <tr>
                <td style="color: #eab308; font-weight: bold;">Medium (41-60)</td>
                <td>Confirm</td>
                <td>Confirm</td>
                <td>Confirm</td>
                <td>Confirm</td>
                <td>Audit</td>
            </tr>
            <tr>
                <td style="color: #10b981; font-weight: bold;">Low (0-40)</td>
                <td>Audit</td>
                <td>Audit</td>
                <td>Audit</td>
                <td>Audit</td>
                <td>Audit</td>
            </tr>
        </table>
    </div>

    <div class="card">
        <h3>ğŸ” IOB (Indicator of Behavior) Tespiti</h3>
        <p><strong>Dosya:</strong> <code>RiskAnalyzer.cs</code> - <code>DetectIOB()</code> metodu</p>
        <p>Belirli davranÄ±ÅŸ kalÄ±plarÄ± tespit edildiÄŸinde IOB kodlarÄ± atanÄ±r:</p>

        <table>
            <tr>
                <th>IOB Kodu</th>
                <th>AÃ§Ä±klama</th>
                <th>Tetikleme KoÅŸulu</th>
            </tr>
            <tr>
                <td><code>IOB-511</code></td>
                <td>Personal Email Exfiltration</td>
                <td>Email kanalÄ± + kiÅŸisel domain (@company.com dÄ±ÅŸÄ±)</td>
            </tr>
            <tr>
                <td><code>IOB-299</code></td>
                <td>USB Data Transfer</td>
                <td>USB kanalÄ± + Severity â‰¥ 7</td>
            </tr>
            <tr>
                <td><code>IOB-811</code></td>
                <td>Cloud Upload</td>
                <td>Cloud kanalÄ± + DataSensitivity â‰¥ 8</td>
            </tr>
            <tr>
                <td><code>IOB-311</code></td>
                <td>Anomalous File Copying (Stockpiling)</td>
                <td>RepeatCount â‰¥ 10</td>
            </tr>
            <tr>
                <td><code>IOB-280</code></td>
                <td>Agent Tampering</td>
                <td>Policy iÃ§inde "Agent" + Severity â‰¥ 8</td>
            </tr>
        </table>

        <pre><code>// IOB tespit Ã¶rneÄŸi
if (incident.Channel == "USB" && incident.Severity >= 7)
{
    iobs.Add("IOB-299"); // USB upload
}

if (incident.RepeatCount >= 10)
{
    iobs.Add("IOB-311"); // Stockpiling
}</code></pre>
    </div>

    <div class="card">
        <h3>ğŸ“ Sabit DeÄŸerler (Constants)</h3>
        <p><strong>Dosya:</strong> <code>DLP.RiskAnalyzer.Shared/Constants/RiskConstants.cs</code></p>

        <h4>Risk Skor EÅŸikleri</h4>
        <pre><code>public static class RiskScores
{
    public const int CriticalThreshold = 91;
    public const int HighThreshold = 61;
    public const int MediumThreshold = 41;
    public const int MaxScore = 100;
    public const int MinScore = 0;
}</code></pre>

        <h4>Desteklenen Kanallar</h4>
        <pre><code>public static class Channels
{
    public const string Cloud = "Cloud";
    public const string CloudStorage = "Cloud Storage";
    public const string Email = "Email";
    public const string NetworkShare = "Network Share";
    public const string RemovableStorage = "Removable Storage";
    public const string Printer = "Printer";
}</code></pre>

        <h4>Veri Hassasiyeti Tipleri</h4>
        <pre><code>public static class DataSensitivity
{
    public const string PII = "pii";
    public const string Personal = "personal";
    public const string PCI = "pci";
    public const string Credit = "credit";
    public const string Confidential = "confidential";
}</code></pre>

        <div class="success">
            <strong>âœ… SonuÃ§:</strong> TÃ¼m eÅŸik deÄŸerleri ve politika aksiyonlarÄ± <code>RiskConstants.cs</code>
            dosyasÄ±nda merkezi olarak tanÄ±mlanmÄ±ÅŸtÄ±r. Bu sayede deÄŸiÅŸiklikler tek noktadan yapÄ±labilir.
        </div>
    </div>

    <h2 id="ai-analiz">7. AI DavranÄ±ÅŸ Analizi</h2>

    <div class="card">
        <p><strong>Dosya:</strong> <code>DLP.RiskAnalyzer.Analyzer/Services/BehaviorEngineService.cs</code></p>

        <h3>Z-Score Anomali Tespiti</h3>
        <pre><code>// Z-score hesaplama: z = (x - Î¼) / Ïƒ
// x: Mevcut deÄŸer, Î¼: Ortalama, Ïƒ: Standart sapma

var incidentCountZ = (currentMean - baselineMean) / baselineStdDev;
var severityZ = (currentAvgSeverity - baselineAvgSeverity) / baselineStdDevSeverity;</code></pre>

        <h3>Anomali Seviyeleri</h3>
        <table>
            <tr>
                <th>Z-Score</th>
                <th>Seviye</th>
                <th>Risk Skoru</th>
            </tr>
            <tr>
                <td>â‰¥ 3.0</td>
                <td>Kritik</td>
                <td>100</td>
            </tr>
            <tr>
                <td>â‰¥ 2.0</td>
                <td>YÃ¼ksek</td>
                <td>80</td>
            </tr>
            <tr>
                <td>â‰¥ 1.0</td>
                <td>Orta</td>
                <td>50</td>
            </tr>
            <tr>
                <td>
                    < 1.0</td>
                <td>DÃ¼ÅŸÃ¼k</td>
                <td>30</td>
            </tr>
        </table>

        <h3>AI Model Entegrasyonu</h3>
        <p>Sistem Ã¼Ã§ AI saÄŸlayÄ±cÄ±sÄ±nÄ± destekler:</p>
        <ul>
            <li><strong>OpenAI:</strong> GPT-4, GPT-4o-mini</li>
            <li><strong>Azure OpenAI:</strong> Kurumsal Azure entegrasyonu</li>
            <li><strong>Local:</strong> Statik aÃ§Ä±klama (AI olmadan)</li>
        </ul>
    </div>

    <h2 id="remediation">8. Olay DÃ¼zeltme (Remediation)</h2>

    <div class="card">
        <p><strong>Dosya:</strong> <code>DLP.RiskAnalyzer.Analyzer/Services/RemediationService.cs</code></p>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="url">/dlp/rest/v1/incidents/update</span>
        </div>
        <pre><code>// Ä°stek Body
{
  "incidentId": "12345",
  "action": "block",           // block, encrypt, notify, audit
  "reason": "Data exfiltration attempt",
  "notes": "User attempted to send PII via personal email"
}</code></pre>
    </div>

    <h2 id="frontend">9. Dashboard (Frontend)</h2>

    <div class="card">
        <p><strong>Dizin:</strong> <code>dashboard/</code></p>

        <h3>Sayfalar</h3>
        <table>
            <tr>
                <th>Sayfa</th>
                <th>Yol</th>
                <th>AÃ§Ä±klama</th>
            </tr>
            <tr>
                <td>Dashboard</td>
                <td><code>/</code></td>
                <td>Ana sayfa, Ã¶zet grafikler</td>
            </tr>
            <tr>
                <td>Investigation</td>
                <td><code>/investigation</code></td>
                <td>KullanÄ±cÄ± inceleme, timeline</td>
            </tr>
            <tr>
                <td>Users</td>
                <td><code>/users</code></td>
                <td>KullanÄ±cÄ± yÃ¶netimi</td>
            </tr>
            <tr>
                <td>Reports</td>
                <td><code>/reports</code></td>
                <td>Rapor oluÅŸturma</td>
            </tr>
            <tr>
                <td>AI Behavioral</td>
                <td><code>/ai-behavioral</code></td>
                <td>AI anomali analizi</td>
            </tr>
            <tr>
                <td>Settings</td>
                <td><code>/settings</code></td>
                <td>Sistem ayarlarÄ±</td>
            </tr>
        </table>

        <h3>API Ä°letiÅŸimi</h3>
        <pre><code>// Ã–rnek API Ã§aÄŸrÄ±sÄ±
const response = await axios.get(`${apiUrl}/api/incidents`, {
    params: {
        start_date: '2024-12-01',
        end_date: '2024-12-10',
        limit: 100,
        order_by: 'risk_score_desc'
    }
});</code></pre>
    </div>

    <h2 id="api-endpoints">10. API Endpoint'leri</h2>

    <div class="card">
        <h3>Incident Endpoint'leri</h3>
        <div class="endpoint"><span class="method get">GET</span><span class="url">/api/incidents</span> - TÃ¼m
            incident'larÄ± listele</div>
        <div class="endpoint"><span class="method get">GET</span><span class="url">/api/incidents/{id}</span> - Tek
            incident detayÄ±</div>
        <div class="endpoint"><span class="method post">POST</span><span
                class="url">/api/incidents/seed-sample-data</span> - Test verisi oluÅŸtur</div>

        <h3>Risk Endpoint'leri</h3>
        <div class="endpoint"><span class="method get">GET</span><span class="url">/api/risk/daily-summary</span> -
            GÃ¼nlÃ¼k Ã¶zet</div>
        <div class="endpoint"><span class="method get">GET</span><span class="url">/api/risk/department-summary</span> -
            Departman Ã¶zeti</div>
        <div class="endpoint"><span class="method get">GET</span><span class="url">/api/risk/user-list</span> -
            KullanÄ±cÄ± risk listesi</div>
        <div class="endpoint"><span class="method get">GET</span><span class="url">/api/risk/action-summary</span> -
            Aksiyon Ã¶zeti (BLOCK, QUARANTINE, AUTHORIZED)</div>
        <div class="endpoint"><span class="method get">GET</span><span class="url">/api/risk/incidents/by-action</span>
            -
            Aksiyona gÃ¶re incident detaylarÄ± <span style="color: #10b981; font-weight: bold;">(YENÄ°)</span></div>

        <h3>AI Behavioral Endpoint'leri</h3>
        <div class="endpoint"><span class="method get">GET</span><span class="url">/api/ai-behavioral/overview</span> -
            AI analiz Ã¶zeti</div>
        <div class="endpoint"><span class="method get">GET</span><span
                class="url">/api/ai-behavioral/entity/{type}/{id}</span> - Entity analizi</div>
        <div class="endpoint"><span class="method post">POST</span><span class="url">/api/ai-behavioral/analyze</span> -
            Yeni analiz baÅŸlat</div>

        <h3>DLP Test Endpoint'leri</h3>
        <div class="endpoint"><span class="method post">POST</span><span class="url">/api/dlptest/connection</span> -
            BaÄŸlantÄ± testi</div>
        <div class="endpoint"><span class="method post">POST</span><span class="url">/api/dlptest/auth</span> - Kimlik
            doÄŸrulama testi</div>
        <div class="endpoint"><span class="method post">POST</span><span class="url">/api/dlptest/incidents</span> -
            Incident Ã§ekme testi</div>
    </div>

    <h2 id="action-summary-modal">11. Action Summary Incident Details (YENÄ° Ã–ZELLÄ°K)</h2>

    <div class="card">
        <div class="success">
            <strong>âœ… Eklendi:</strong> 18 AralÄ±k 2024 - Dashboard ve Reports sayfalarÄ±nda Action Summary kartlarÄ± artÄ±k
            tÄ±klanabilir.
        </div>

        <h3>ğŸ“‹ Ã–zellik AÃ§Ä±klamasÄ±</h3>
        <p>Dashboard ve Reports sayfalarÄ±ndaki <strong>BLOCK</strong> ve <strong>QUARANTINE</strong> aksiyonlarÄ±na
            tÄ±klandÄ±ÄŸÄ±nda,
            ilgili tarihteki tÃ¼m incident'larÄ±n detaylarÄ±nÄ± gÃ¶steren bir modal aÃ§Ä±lÄ±r.</p>

        <h3>ğŸ¯ KullanÄ±m Senaryosu</h3>
        <table>
            <tr>
                <th>Kart</th>
                <th>Renk</th>
                <th>TÄ±klandÄ±ÄŸÄ±nda</th>
            </tr>
            <tr>
                <td style="font-weight: bold; color: #ef4444;">BLOCK</td>
                <td>ğŸ”´ KÄ±rmÄ±zÄ±</td>
                <td>BloklanmÄ±ÅŸ incident'larÄ±n listesi</td>
            </tr>
            <tr>
                <td style="font-weight: bold; color: #8b5cf6;">QUARANTINE</td>
                <td>ğŸŸ£ Mor</td>
                <td>Karantinaya alÄ±nmÄ±ÅŸ incident'larÄ±n listesi</td>
            </tr>
        </table>

        <h3>ğŸ“Š Modal Ä°Ã§eriÄŸi</h3>
        <p>Modal'da gÃ¶sterilen kolonlar:</p>
        <table>
            <tr>
                <th>#</th>
                <th>Kolon</th>
                <th>AÃ§Ä±klama</th>
            </tr>
            <tr>
                <td>1</td>
                <td>Login Name</td>
                <td>KullanÄ±cÄ± adÄ± (Ã¶rn: KUVEYTTURK\ahmet.yilmaz)</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Destination</td>
                <td>Hedef adres (email, URL, vb.)</td>
            </tr>
            <tr>
                <td>3</td>
                <td>Channel</td>
                <td>Kanal (EMAIL, CLOUD, USB, vb.)</td>
            </tr>
            <tr>
                <td>4</td>
                <td>Policy/Rule</td>
                <td>Tetiklenen politika ve kural adÄ±</td>
            </tr>
            <tr>
                <td>5</td>
                <td>Time</td>
                <td>Olay zamanÄ± (HH:MM:SS)</td>
            </tr>
        </table>
    </div>

    <div class="card">
        <h3>ğŸ”Œ API Endpoint</h3>
        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="url">/api/risk/incidents/by-action</span>
        </div>

        <h4>Parametreler:</h4>
        <table>
            <tr>
                <th>Parametre</th>
                <th>Tip</th>
                <th>Zorunlu</th>
                <th>AÃ§Ä±klama</th>
            </tr>
            <tr>
                <td><code>action</code></td>
                <td>string</td>
                <td>âœ… Evet</td>
                <td>BLOCK, QUARANTINE veya AUTHORIZED</td>
            </tr>
            <tr>
                <td><code>date</code></td>
                <td>string</td>
                <td>âŒ HayÄ±r</td>
                <td>Tek tarih (yyyy-MM-dd) - Reports iÃ§in</td>
            </tr>
            <tr>
                <td><code>start_date</code></td>
                <td>string</td>
                <td>âŒ HayÄ±r</td>
                <td>BaÅŸlangÄ±Ã§ tarihi - Dashboard iÃ§in</td>
            </tr>
            <tr>
                <td><code>end_date</code></td>
                <td>string</td>
                <td>âŒ HayÄ±r</td>
                <td>BitiÅŸ tarihi - Dashboard iÃ§in</td>
            </tr>
        </table>

        <h4>Ã–rnek Ä°stek:</h4>
        <pre><code>// Reports (tek gÃ¼n)
GET /api/risk/incidents/by-action?action=BLOCK&date=2024-12-18

// Dashboard (30 gÃ¼n aralÄ±ÄŸÄ±)
GET /api/risk/incidents/by-action?action=BLOCK&start_date=2024-11-18&end_date=2024-12-18</code></pre>

        <h4>Ã–rnek YanÄ±t:</h4>
        <pre><code>[
  {
    "login_name": "KUVEYTTURK\\ahmet.yilmaz",
    "destination": "user@external.com",
    "channel": "EMAIL",
    "policy": "KT PCI/PII-KW Politikasi",
    "rule_name": "Credit Card Detection",
    "timestamp": "2024-12-18 14:30:25"
  },
  ...
]</code></pre>
    </div>

    <div class="card">
        <h3>ğŸ’» Frontend BileÅŸenleri</h3>

        <h4>1. ActionIncidentsModal Component</h4>
        <p><strong>Dosya:</strong> <code>dashboard/components/ActionIncidentsModal.tsx</code></p>
        <p>Yeniden kullanÄ±labilir modal bileÅŸeni. Props:</p>
        <pre><code>interface ActionIncidentsModalProps {
    isOpen: boolean;
    onClose: () => void;
    action: string;         // "BLOCK" veya "QUARANTINE"
    date: string;           // GÃ¶sterilecek tarih
    incidents: Incident[];  // Incident listesi
    loading: boolean;       // YÃ¼kleniyor durumu
}</code></pre>

        <h4>2. Dashboard Entegrasyonu</h4>
        <p><strong>Dosya:</strong> <code>dashboard/app/page.tsx</code></p>
        <ul>
            <li>BLOCK ve QUARANTINE kartlarÄ±na <code>onClick</code> handler eklendi</li>
            <li>30 gÃ¼nlÃ¼k tarih aralÄ±ÄŸÄ± gÃ¶nderiliyor (<code>start_date</code>, <code>end_date</code>)</li>
            <li>Hover efektleri eklendi (cursor, shadow, transform)</li>
        </ul>

        <h4>3. Reports Entegrasyonu</h4>
        <p><strong>Dosya:</strong> <code>dashboard/app/reports/page.tsx</code></p>
        <ul>
            <li>SeÃ§ili gÃ¼ne gÃ¶re tek tarih gÃ¶nderiliyor (<code>date</code>)</li>
            <li>Daily Summary kartlarÄ± tÄ±klanabilir</li>
        </ul>
    </div>

    <div class="card">
        <h3>ï¿½ Backend Implementation</h3>
        <p><strong>Dosya:</strong> <code>DLP.RiskAnalyzer.Analyzer/Controllers/RiskController.cs</code></p>

        <h4>Ã–nemli Noktalar:</h4>
        <ul>
            <li><strong>Action Matching:</strong> "BLOCK" ile "BLOCKED", "QUARANTINE" ile "QUARANTINED" eÅŸleÅŸtirilir
            </li>
            <li><strong>Rule Name Extraction:</strong> <code>ViolationTriggers</code> JSON alanÄ±ndan parse edilir</li>
            <li><strong>Login Name Priority:</strong> <code>email_address</code> yerine <code>login_name</code> tercih
                edilir (genellikle dolu)</li>
            <li><strong>Date Range Support:</strong> Hem tek tarih hem aralÄ±k desteklenir</li>
        </ul>
    </div>

    <div class="info" style="margin-top: 40px;">
        <strong>ï¿½ğŸ“ Not:</strong> Bu dokÃ¼mantasyon tarayÄ±cÄ±da PDF olarak yazdÄ±rÄ±labilir (Ctrl+P veya Cmd+P).
    </div>

    <div style="text-align: center; margin-top: 30px; color: #666; font-size: 13px;">
        <p>Son GÃ¼ncelleme: 18 AralÄ±k 2024 | Versiyon 1.1</p>
    </div>

</body>

</html>